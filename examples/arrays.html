<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Application Shell</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
</head>
<body style="box-sizing: content-box; margin-inline: auto; max-inline-size: 60vw; margin-top: 10vh;">
    <article>
      <h1>Activate / Deactivate Users</h1>
      <user-list-component></user-list-component>
    </article>
    <script type="module">
      import { createStore, html, ReactiveElement } from './build/cami.module.js';

      // Step 1: Define the initial state of our store
      const userStore = createStore({
        users: [
          { id: 1, name: "Alice", status: "Active" },
          { id: 2, name: "Bob", status: "Inactive" },
        ],
      });

      // Step 2: Register a reducer for updating a user's status
      userStore.register('updateStatus', (draftStore, payload) => {
        const user = draftStore.users.find(user => user.id === payload.id);
        if (user) {
          user.status = payload.status;
        }
      });

      // Step 3: Define a custom element that uses the store
      class UserListElement extends ReactiveElement {
        constructor() {
          super();
          this.bindStore('users', userStore);
        }

        template() {
          return html`
            <ul>
              ${this.users.map(user => html`
                <li>
                  ${user.name} - ${user.status}
                  <button @click=${() => this.dispatch("updateStatus", { id: user.id, status: "Active" })}>Activate</button>
                  <button @click=${() => this.dispatch("updateStatus", { id: user.id, status: "Inactive" })}>Deactivate</button>
                </li>
              `)}
            </ul>
          `;
        }
      }

      customElements.define('user-list-component', UserListElement);

    </script>
    <script src="./js/pico-theme-switch.js"></script>
</body>
</html>
