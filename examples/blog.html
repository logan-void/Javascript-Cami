<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Application Shell</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
</head>
<body style="box-sizing: content-box; margin-inline: auto; max-inline-size: 60vw; margin-top: 10vh;">
    <h1>Blog</h1>
    <blog-component></blog-component>
    <script type="module">
      import { html, ReactiveElement } from './build/cami.module.js';

      class PostElement extends ReactiveElement {
        constructor() {
          super();
          this.observable('title', '');
          this.observable('body', '');
        }

        template() {
          return html`
            <article>
              <h2>${this.title}</h2>
              <p>${this.body}</p>
            </article>
          `;
        }
      }

      customElements.define('post-component', PostElement);

      class BlogElement extends ReactiveElement {
        constructor() {
          super();
          this.observable('posts', []);
        }

        connectedCallback() {
          super.connectedCallback();
          this.fetchPosts();
        }

        async fetchPosts() {
          const response = await fetch('https://jsonplaceholder.typicode.com/posts');
          const posts = await response.json();
          this.posts = posts.slice(0, 10);
        }

        template() {
          return html`
            <section>
              ${this.posts.map(post => html`
                <post-component .title=${post.title} .body=${post.body}></post-component>
              `)}
            </section>
          `;
        }
      }

      customElements.define('blog-component', BlogElement);

    </script>
    <script src="./js/pico-theme-switch.js"></script>
</body>
</html>
